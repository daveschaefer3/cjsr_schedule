<html>
<head>
  <meta charset="UTF-8">
  <title>CJSR Program Schedule</title>

  <link rel="stylesheet" type="text/css" href="css/schedule.css" />
  <link rel="stylesheet" href="css/bootstrap.min.css" media="screen">
  <script type="text/javascript" src="javascripts/lib/jquery-1.10.2.min.js"></script>
  <script type="text/javascript" src="javascripts/lib/handlebars-1.0.0.js"></script>
  <script type="text/javascript" src="javascripts/lib/json2.js"></script>

  <script type="text/javascript" src="javascripts/showJson.js"></script>
  <script type="text/javascript" src="javascripts/templateHelpers.js"></script>
  <script type="text/javascript">
    // custom Handlebars template helpers

    Handlebars.registerHelper("");
  </script>

  <script type="text/javascript">
    // template filling
    
    $(function(){
      // 
      // $('#days-box').append(JSON.stringify(showJson));

      var shows = showJson.shows;
      var dayList = [
        {theDay: "sun", fullDay: "Sunday"},
        {theDay: "mon", fullDay: "Monday"},
        {theDay: "tues", fullDay: "Tuesday"},
        {theDay: "wed", fullDay: "Wednesday"},
        {theDay: "thurs", fullDay: "Thursday"},
        {theDay: "fri", fullDay: "Friday"},
        {theDay: "sat", fullDay: "Saturday"}
      ];

      for(var i=0; i < 24; i++) {
        var timeBlock = "";
        var iPlus = (i + 6);
        var iMinus = (i - 6);
        var jMinus = (i - 18);
        if (i <= 6) {
          timeBlock += '<div class="timeBlock ' + iPlus + '00">';
          timeBlock += iPlus + ':00' + ((i==6) ? 'PM' : 'AM');
          timeBlock += '</div><div class="timeBlock ';
          timeBlock += iPlus + '30">' + iPlus + ':30';
          timeBlock += ((i==6) ? 'PM' : 'AM') +'</div>';
        } else {
          timeBlock += '<div class="timeBlock ';
          timeBlock += ((iPlus < 24) ? iPlus : jMinus) + '00">';
          timeBlock += ((iMinus > 12) ? jMinus : iMinus) + ':00';
          timeBlock += ((iMinus >= 12) ? 'AM' : 'PM'); 
          timeBlock += '</div><div class="timeBlock ';
          timeBlock += ((iPlus < 24) ? iPlus : jMinus) + '30">';
          timeBlock += ((iMinus > 12) ? jMinus : iMinus) + ':30';
          timeBlock += ((iMinus >= 12) ? 'AM' : 'PM') + '</div>';
        }

        $('.timestrip').append(timeBlock);
      };

      var daySource = $('#day-template').html();
      var showSource = $('#show-template').html();



      for (var i=0; i < dayList.length; i++) {
        var dayTemplate = Handlebars.compile(daySource);
        var dayHtml = dayTemplate(dayList[i]);
        $('#days-box').append(dayHtml);
      };

      // set the height for .day to the height of .timestrip
      var boxHeight = $('.timestrip').height();
      $('.day').height(boxHeight);

      for (var n=0; n < shows.length; n++) {
        var show = shows[n];
        var columnDump = "#" + show.day;

        var showTemplate = Handlebars.compile(showSource);
        var showHtml = showTemplate(show);
        $(columnDump).append(showHtml);
      };

    });
  </script>
</head>
<body>
<div id="container" class="span-16">
  <div id="titleBox"><h1>CJSR 88.5 FM - Program Schedule</h1></div>
  <span class="clearFix"></span>

  <!-- <div class="timestrip span-1 column" id="left-times">
    <div class="dayHeader"></div>
  </div>
  <div id="days-box">

  </div>
  <div class="timestrip span-1 column" id="right-times">
    <div class="dayHeader"></div>
  </div> -->

  <table id="schedTable" class="table table-bordered">
    <thead>
      <td>Time</td>
      <td>Sunday</td>
      <td>Monday</td>
      <td>Tuesday</td>
      <td>Wednesday</td>
      <td>Thursday</td>
      <td>Friday</td>
      <td>Saturday</td>
      <td>Time</td>
    </thead>
    <tbody id="tableBody">
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      
    </tbody>
  </table>  
</div>
<span class="clearFix"></span>



<!-- TEMPLATES START -->
<script id="day-template" type="text/x-handlebars-template">
  <div class="day span-2 column" id="{{theDay}}">
    <div class="dayHeader"><strong>{{fullDay}}</strong></div>
  </div>
</script>

<script id="show-template" type="text/x-handlebars-template">
  <div class="show start-{{start}} end-{{end}}" id="show-{{id}}">
    <span>{{{name}}}</span>
  </div>
</script>

<script id="row-template" type="text/x-handlebars-template">
  <tr class="{{row-{{row}}">
    <td>{{time}}</td>
    <td>{{sun}}</td>
    <td>{{mon}}</td>
    <td>{{tues}}</td>
    <td>{{wed}}</td>
    <td>{{thurs}}</td>
    <td>{{fri}}</td>
    <td>{{sat}}</td>
    <td>{{time}}</td>
  </tr>
</script>
<!-- TEMPLATES END -->

<script type="text/javascript" src="javascripts/lib/bootstrap.min.js"></script>

</body>
</html>